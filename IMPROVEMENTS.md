# Improvements

## Idempotency in Transactions

To prevent duplicate transactions and ensure that each transaction request is processed only once, we can implement idempotency checks.

We can extend the `transactions` service by adding an idempotency key to each transaction request. The key can be a UUID or request hash generated by the server in a pre-transaction request.

This key is included in the header or as part of the transaction JSON body. While processing the actual transcation the server will then check if a transaction with the same idempotency key has been processed before and, if so, skip processing it again while returning the original transaction result. This feature not only enhances reliability and consistency but also improves user experience by handling retries safely.


**Transfer Funds with Idempotency**: 

POST /tx-preflight with JSON body {"source_account_id": 123, "destination_account_id": 234, "amount": "50.00"} responds with JSON {"idempotency_key": "xyz"}

POST /transactions with headers Idempotency-Key: <key-from-prefligt-request> and JSON body {"source_account_id": 123, "destination_account_id": 234, "amount": "50.00"}